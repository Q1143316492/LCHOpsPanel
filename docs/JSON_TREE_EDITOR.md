# JSON 树形编辑器

## 功能概述

JSON 树形编辑器是 LCH Ops Panel 扩展的新功能，提供了类似 Unreal Engine Data Asset 的树形编辑体验，让 JSON 文件的编辑变得更加直观和高效。

## 主要特性

### 🌳 树形结构显示
- 以树形结构展示 JSON 数据
- 支持展开/折叠节点
- 清晰的层级缩进显示
- 类型标识（string、number、boolean、object、array、null）

### 🎨 深色主题支持
- 完全兼容 VSCode 深色主题
- 使用 VSCode 原生颜色变量
- 自适应主题切换

### ✏️ 直观编辑体验
- 直接在树形结构中编辑键名和值
- 支持多行文本编辑
- 实时类型检测和转换
- 智能输入框（字符串、数字、布尔值等）

### 🔧 强大的编辑功能
- **添加属性**：在任意对象或数组中添加新属性
- **删除属性**：快速删除不需要的属性
- **重命名键**：直接编辑属性名称
- **类型转换**：自动识别并转换数据类型
- **展开/折叠控制**：
  - 展开全部：一键展开所有节点
  - 折叠全部：一键折叠所有节点
  - 单节点控制：点击箭头展开/折叠单个节点

## 使用方法

### 打开 JSON 树形编辑器

有三种方式可以打开 JSON 树形编辑器：

1. **通过编辑器标题栏按钮**
   - 打开任意 `.json` 文件
   - 点击编辑器右上角的树形结构图标 `$(symbol-structure)`

2. **通过命令面板**
   - 按 `Ctrl+Shift+P` 打开命令面板
   - 输入 "Open JSON Tree Editor"
   - 选择要编辑的 JSON 文件

3. **通过右键菜单**
   - 在文件资源管理器中右键点击 `.json` 文件
   - 选择 "Open with JSON Tree Editor"

### 编辑操作

#### 编辑值
- 点击任意值即可开始编辑
- 支持的数据类型：
  - **字符串**：直接输入文本
  - **数字**：输入数字，自动转换类型
  - **布尔值**：输入 `true` 或 `false`
  - **null**：输入 `null`
  - **多行字符串**：自动检测换行符，显示为文本域

#### 编辑键名
- 点击属性名即可重命名
- 按 `Enter` 确认，`Esc` 取消

#### 添加属性
- 将鼠标悬停在对象或数组节点上
- 点击 `+` 按钮
- 输入属性名和选择数据类型

#### 删除属性
- 将鼠标悬停在任意节点上
- 点击 `×` 按钮
- 确认删除操作

### 工具栏功能

- **保存**：将更改保存到文件
- **展开全部**：展开所有节点
- **折叠全部**：折叠所有节点
- **添加根属性**：在根对象中添加新属性

## 键盘快捷键

- `Enter`：确认编辑
- `Esc`：取消编辑
- `Ctrl+Enter`：在多行文本编辑中确认

## 支持的数据类型

| 类型 | 显示颜色 | 示例 |
|------|----------|------|
| String | 橙色 | `"Hello World"` |
| Number | 绿色 | `42`, `3.14` |
| Boolean | 蓝色 | `true`, `false` |
| Null | 蓝色斜体 | `null` |
| Object | 青色 | `Object{3}` |
| Array | 青色 | `Array[5]` |

## 注意事项

1. **自动保存**：编辑器会在每次更改后自动保存到文件
2. **JSON 格式**：确保 JSON 格式正确，否则会显示错误信息
3. **大文件性能**：对于非常大的 JSON 文件，建议使用传统文本编辑器
4. **备份建议**：编辑重要配置文件前建议先备份

## 故障排除

### 常见问题

**Q: 无法打开树形编辑器**
- 确保文件扩展名为 `.json`
- 检查 JSON 格式是否正确
- 重新加载 VSCode 窗口

**Q: 编辑后数据丢失**
- 检查文件权限
- 确保磁盘空间充足
- 查看 VSCode 输出面板的错误信息

**Q: 主题颜色不正确**
- 重启 VSCode
- 检查主题设置
- 更新扩展到最新版本

## 更新日志

### v1.4.0
- ✨ 新增 JSON 树形编辑器功能
- 🎨 完整的深色主题支持
- 🔧 直观的树形编辑界面
- ⚡ 实时保存和类型转换


## 使用示例

### 快速开始

1. **打开测试文件**
   - 在项目中找到 `test-config.json` 文件
   - 右键点击文件，选择 "Open with JSON Tree Editor"
   - 或者打开文件后，点击编辑器右上角的树形结构图标

2. **体验树形编辑**
   - 展开 `settings` 节点查看嵌套配置
   - 点击 `theme` 的值，将其从 "dark" 改为 "light"
   - 展开 `features.notifications` 查看数组和对象的混合结构

3. **添加新属性**
   - 悬停在 `settings` 节点上，点击 `+` 按钮
   - 输入属性名：`fontSize`
   - 选择类型：`number`
   - 设置值：`14`

4. **管理数组**
   - 展开 `servers` 数组
   - 悬停在数组节点上，点击 `+` 添加新服务器
   - 或删除不需要的服务器配置

### 高级功能

#### 多行文本编辑
- 在 `logging.file` 中输入包含换行符的路径
- 编辑器会自动切换到多行文本模式

#### 类型转换
- 在 `database.connection.port` 中输入文本 "5432"
- 编辑器会自动识别并转换为数字类型

#### 批量操作
- 使用 "展开全部" 查看完整结构
- 使用 "折叠全部" 简化视图
- 使用 "添加根属性" 快速添加顶级配置

### 对比传统编辑

**传统 JSON 编辑**：
```json
{
  "database": {
    "connection": {
      "host": "db.example.com",
      "port": 5432,
      "password": null
    }
  }
}
```

**树形编辑器**：
```
▼ database                    Object{1}
  ▼ connection                Object{3}
    📝 host: db.example.com   string
    🔢 port: 5432             number  
    ❌ password: null         null
```

### 使用场景

1. **配置文件管理**：项目配置、环境变量、构建设置
2. **API 响应调试**：查看和编辑复杂的 JSON 响应
3. **数据结构设计**：可视化设计 JSON Schema
4. **文档编写**：为 JSON 格式的文档提供更好的编辑体验

### 提示和技巧

- 💡 使用 `Ctrl+S` 随时保存更改
- 💡 长按节点展开按钮可以展开所有子节点
- 💡 在输入框中按 `Tab` 可以快速切换到下一个可编辑字段
- 💡 使用 `Esc` 可以取消当前编辑操作
- 💡 对于大型 JSON 文件，建议先折叠不相关的部分